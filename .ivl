
function build(){
    FILE="$1"
    shift
    ${CXX:-g++} -DIVL_LOCAL "$@" -O3 -std=c++${CXXVER:-20} -I"$LOC/include2" -I"$LOC/include" $FILE.cpp -o $FILE ${CXXPOST:-}
}

function render(){
    $LOC/render-includes/renderer.sh -c "${CXX:-g++}" -e "-I $LOC/include" $1.cpp > $1.rendered.cpp
}

# `cargo install cce` needed
function refl-build(){
    render "$1"
    cce compile edg-experimental-reflection "$1.rendered.cpp"
}

function list-dir(){
    ls -lahnAB --color=always "${1:-.}" | grep -v rendered
}

ivl_add_command "build" "LOC=\"$IVL_DOT_LOCATION\" build"

ivl_add_command "render" "LOC=\"$IVL_DOT_LOCATION\" render"

# `cargo install cce` needed
ivl_add_command "refl-build" "LOC=\"$IVL_DOT_LOCATION\" refl-build"

ivl_add_command "ls" "LOC=\"$IVL_DOT_LOCATION\" list-dir"

# function run(){
#     PROG="$1"
#     shift
#     "$LOC/build/$PROG" "$@"
# }

# ivl_add_command "run" "$IVL_DOT_LOCATION/run-everything.sh"
